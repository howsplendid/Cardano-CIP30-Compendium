<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>HTML 5 Boilerplate</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <main>
        <h1>Cardano CIP-00030 Compendium</h1>
        <section>
            <h2>To open a wallet (in this case Nami)</h2>
            <p>example:</p>
            <code>window.cardano.nami.enable();</code>
            <button onclick="walletEnable('nami')">Open Nami</button>
            <code>window.cardano.yoroi.enable();</code>
            <button onclick="walletEnable('yoroi')">Open Yoroi</button>
            <h2>To see if a wallet is enabled</h2>
            <p>example:</p>
            <code>window.cardano.yoroi.isEnabled();</code>
            <button onclick="walletIsEnabled('nami')">is Nami enabled?</button>
            <code>window.cardano.yoroi.isEnabled();</code>
            <button onclick="walletIsEnabled('yoroi')">is Yoroi enabled?</button>
            <h2>The wallet icon</h2>
            <p>example:</p>
            <code>window.cardano.nami.icon</code>
            <span id="fooBar">&nbsp;</span>
            <div id="imageDiv"></div>
            <h2>The wallet API version</h2>
            <p>example:</p>
            <code>window.cardano.nami.apiVersion</code>
        </section>
        <section>
            <h2>These are to follow with the JS SDK</h2>
            <h2>Get the balance of the wallet</h2>
            <p>example:</p>
            <code>window.cardano.nami.isEnabled().then(api => api.getBalance())</code>
            <h2>Unused Addresses in the wallet</h2>
            <p>example:</p>
            <code>window.cardano.nami.enable().then(api => api.getUnusedAddresses())</code>
            <h2>Used Addresses in the wallet</h2>
            <p>example:</p>
            <code>window.cardano.nami.enable().then(api => api.getUsedAddresses())</code>
            <h2>Submit a transaction</h2>
            <p>example:</p>
            <code>window.cardano.nami.enable().then(api => api.submitTx())</code>
        </section>
    </main>
    <script src="./cbor.js" type="text/javascript"></script>
    <script>
        function walletEnable(walletType) {
            console.log("wallet enable, " + walletType);
            let p = walletType;
            window.cardano[p].enable();

            /**
             * This is WIP
             * In order to get some of the functionality to be instaticated, we have to open a wallet first
             * So things like icons, will be triggered by the enable button
             * I will be working on this as there are CIP-30 flaws in  most wallets, ie. Yoroi doesn't have an icon
             * 
             */

            /**
             * Icon
             * 
             */

            console.log(window.cardano.nami.icon);
            document.getElementById('imageDiv').innerHTML =
                '<img width="100" height="100" alt="icon" src="' + window.cardano.nami.icon + '">';
        }

        function walletIsEnabled(walletType) {
            console.log("wallet isEnabled, " + walletType);
            let p = walletType;
            window.cardano[p].isEnabled().then(console.log());
        }
    </script>
</body>

</html>